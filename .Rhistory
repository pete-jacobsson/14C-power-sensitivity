x = xlab
)
}
plot_simulation_results_osc(range_to_plot = c(10, 15), hpd_area = "accuracy_68",
variable = "curve_uncert", rounding = 5,
xlab = "Calibration curve uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(24, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 2.5,
xlab = "Measurement uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(24, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 2.5,
xlab = "Measurement uncertainty",
offset_dir = "neg")
plot_simulation_results_osc(range_to_plot = c(0, 50), hpd_area = "accuracy_68",
variable = "offset_magnitude", rounding = 2,
xlab = "Offset magnitude",
offset_dir = "pos")
plot_simulation_results_osc <- function(range_to_plot, hpd_area, variable,
rounding, xlab, offset_dir) {
##This function plots the simulation results for the purposes of the results graphing
single_cals_curve_uncert_mod <- read_csv("single_cals_w_curve_uncert.csv") |>
mutate(sigma_curve_uncert = sqrt((measurement_error^2) + (curve_uncert^2)))
if (str_detect(offset_dir, "pos")) {
single_cals_curve_uncert_mod <- filter(single_cals_curve_uncert_mod,
offset_magnitude > 0)
} else {
single_cals_curve_uncert_mod <- filter(single_cals_curve_uncert_mod,
offset_magnitude <= 0)
}
single_cals_curve_uncert_mod |>
rename(variable_to_plot = variable, hpd_to_plot = hpd_area) |>
filter(variable_to_plot >= range_to_plot[1] &
variable_to_plot <= range_to_plot) |>
mutate(
variable_to_plot = plyr::round_any(variable_to_plot, rounding)
) |>
select(variable_to_plot, hpd_to_plot) |>
group_by(variable_to_plot) |>
summarize(
ratio_accurate = mean(hpd_to_plot)
) |>
ggplot(aes(x = variable_to_plot, y = ratio_accurate)) +
geom_bar(stat = 'identity', fill = "steelblue") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", linewidth = 0.5),
text = element_text(family = "Corbel")#,
#axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 9)
) +
labs(
y = "Ratio accurate",
x = xlab
)
}
plot_simulation_results_osc(range_to_plot = c(10, 15), hpd_area = "accuracy_68",
variable = "curve_uncert", rounding = 5,
xlab = "Calibration curve uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(24, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 2.5,
xlab = "Measurement uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(24, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 2.5,
xlab = "Measurement uncertainty",
offset_dir = "neg")
plot_simulation_results_osc(range_to_plot = c(0, 50), hpd_area = "accuracy_68",
variable = "offset_magnitude", rounding = 2,
xlab = "Offset magnitude",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(10, 15), hpd_area = "accuracy_68",
variable = "curve_uncert", rounding = 5,
xlab = "Calibration curve uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(10, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 1,
xlab = "Measurement uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(10, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 1,
xlab = "Measurement uncertainty",
offset_dir = "neg")
plot_simulation_results_osc(range_to_plot = c(0, 50), hpd_area = "accuracy_68",
variable = "offset_magnitude", rounding = 2,
xlab = "Offset magnitude",
offset_dir = "pos")
### Now plot over simulations
plot_stan_over_sims <- function (model, range_to_plot, hpd_area, variable, rounding,
xlab = "", n_draws, median_other){
p <- plot_simulation_results_osc(range_to_plot = range_to_plot,
hpd_area = hpd_area,
variable = variable,
rounding = rounding,
xlab = xlab,
offset_dir = model)
for (i in 1:n_draws) {
other_param <- draw_other_param(variable)
sample_predict <- draw_predict_random(model = model,
param_plotted = variable,
value_range = seq(range_to_plot[1],
range_to_plot[2],
0.5),
other_param = other_param) |>
rename(variable_to_plot = 1, ratio_accurate = 2)
p <- p + geom_line(data = sample_predict, linewidth = 0.1, linetype = 1)
}
median_predicts <- draw_predict_median(model = model,
param_plotted = variable,
value_range = seq(range_to_plot[1],
range_to_plot[2],
0.5),
other_param = median_other) |>
rename(variable_to_plot = 1, ratio_accurate = 2)
p <- p +  geom_line(data = median_predicts)
p
}
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25)
plot_stan_over_sims(posterior_95_pos,
range_to_plot = c(10, 30),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25)
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25)
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(10, 40),
hpd_area = "accuracy_68",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25)
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(-50, 0),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25)
plot_stan_over_sims(posterior_95_pos,
range_to_plot = c(10, 30),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25)
### Now plot over simulations
plot_stan_over_sims <- function (model, range_to_plot, hpd_area, variable, rounding,
xlab = "", n_draws, median_other, offset_dir){
p <- plot_simulation_results_osc(range_to_plot = range_to_plot,
hpd_area = hpd_area,
variable = variable,
rounding = rounding,
xlab = xlab,
offset_dir = offset_dir)
for (i in 1:n_draws) {
other_param <- draw_other_param(variable)
sample_predict <- draw_predict_random(model = model,
param_plotted = variable,
value_range = seq(range_to_plot[1],
range_to_plot[2],
0.5),
other_param = other_param) |>
rename(variable_to_plot = 1, ratio_accurate = 2)
p <- p + geom_line(data = sample_predict, linewidth = 0.1, linetype = 1)
}
median_predicts <- draw_predict_median(model = model,
param_plotted = variable,
value_range = seq(range_to_plot[1],
range_to_plot[2],
0.5),
other_param = median_other) |>
rename(variable_to_plot = 1, ratio_accurate = 2)
p <- p +  geom_line(data = median_predicts)
p
}
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(-50, 0),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_95_pos,
range_to_plot = c(10, 30),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_68_neg,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_95_neg,
range_to_plot = c(10, 30),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25)
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(10, 40),
hpd_area = "accuracy_68",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_simulation_results_osc <- function(range_to_plot, hpd_area, variable,
rounding, xlab, offset_dir) {
##This function plots the simulation results for the purposes of the results graphing
single_cals_curve_uncert_mod <- read_csv("single_cals_w_curve_uncert.csv") |>
mutate(sigma_curve_uncert = sqrt((measurement_error^2) + (curve_uncert^2)))
if (str_detect(offset_dir, "pos")) {
single_cals_curve_uncert_mod <- filter(single_cals_curve_uncert_mod,
offset_magnitude >= 0)
} else {
single_cals_curve_uncert_mod <- filter(single_cals_curve_uncert_mod,
offset_magnitude < 0)
}
return(single_cals_curve_uncert_mod)
single_cals_curve_uncert_mod |>
rename(variable_to_plot = variable, hpd_to_plot = hpd_area) |>
filter(variable_to_plot >= range_to_plot[1] &
variable_to_plot <= range_to_plot) |>
mutate(
variable_to_plot = plyr::round_any(variable_to_plot, rounding)
) |>
select(variable_to_plot, hpd_to_plot) |>
group_by(variable_to_plot) |>
summarize(
ratio_accurate = mean(hpd_to_plot)
) |>
ggplot(aes(x = variable_to_plot, y = ratio_accurate)) +
geom_bar(stat = 'identity', fill = "steelblue") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", linewidth = 0.5),
text = element_text(family = "Corbel")#,
#axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 9)
) +
labs(
y = "Ratio accurate",
x = xlab
)
}
plot_simulation_results_osc(range_to_plot = c(10, 15), hpd_area = "accuracy_68",
variable = "curve_uncert", rounding = 5,
xlab = "Calibration curve uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(10, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 1,
xlab = "Measurement uncertainty",
offset_dir = "pos")
plot_simulation_results_osc(range_to_plot = c(10, 50), hpd_area = "accuracy_95",
variable = "measurement_error", rounding = 1,
xlab = "Measurement uncertainty",
offset_dir = "neg")
plot_simulation_results_osc(range_to_plot = c(0, 50), hpd_area = "accuracy_68",
variable = "offset_magnitude", rounding = 2,
xlab = "Offset magnitude",
offset_dir = "pos")
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25,
offset_dir = "pos")
plot_simulation_results_osc <- function(range_to_plot, hpd_area, variable,
rounding, xlab, offset_dir) {
##This function plots the simulation results for the purposes of the results graphing
single_cals_curve_uncert_mod <- read_csv("single_cals_w_curve_uncert.csv") |>
mutate(sigma_curve_uncert = sqrt((measurement_error^2) + (curve_uncert^2)))
if (str_detect(offset_dir, "pos")) {
single_cals_curve_uncert_mod <- filter(single_cals_curve_uncert_mod,
offset_magnitude >= 0)
} else {
single_cals_curve_uncert_mod <- filter(single_cals_curve_uncert_mod,
offset_magnitude < 0)
}
# return(single_cals_curve_uncert_mod)
single_cals_curve_uncert_mod |>
rename(variable_to_plot = variable, hpd_to_plot = hpd_area) |>
filter(variable_to_plot >= range_to_plot[1] &
variable_to_plot <= range_to_plot) |>
mutate(
variable_to_plot = plyr::round_any(variable_to_plot, rounding)
) |>
select(variable_to_plot, hpd_to_plot) |>
group_by(variable_to_plot) |>
summarize(
ratio_accurate = mean(hpd_to_plot)
) |>
ggplot(aes(x = variable_to_plot, y = ratio_accurate)) +
geom_bar(stat = 'identity', fill = "steelblue") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", linewidth = 0.5),
text = element_text(family = "Corbel")#,
#axis.text.x = element_text(angle = 45, vjust = 1, hjust=1, size = 9)
) +
labs(
y = "Ratio accurate",
x = xlab
)
}
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_68_neg,
range_to_plot = c(-50, 0),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 5,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_95_neg,
range_to_plot = c(10, 30),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_68_neg,
range_to_plot = c(-50, 0),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_68_neg,
range_to_plot = c(10, 30),
hpd_area = "accuracy_68",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_95_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_95",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_95_pos,
range_to_plot = c(10, 40),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_68_pos,
range_to_plot = c(10, 50),
hpd_area = "accuracy_68",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_68_neg,
range_to_plot = c(-50, 0),
hpd_area = "accuracy_68",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_68_neg,
range_to_plot = c(10, 50),
hpd_area = "accuracy_68",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_95_pos,
range_to_plot = c(0, 50),
hpd_area = "accuracy_95",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_95_pos,
range_to_plot = c(10, 50),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "pos")
plot_stan_over_sims(posterior_95_neg,
range_to_plot = c(-50, 0),
hpd_area = "accuracy_95",
variable = "offset_magnitude",
rounding = 2,
xlab = "Offset magnitude",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
plot_stan_over_sims(posterior_95_neg,
range_to_plot = c(10, 50),
hpd_area = "accuracy_95",
variable = "sigma_curve_uncert",
rounding = 1,
xlab = "Error and curve uncertainty",
n_draws = 50,
median_other = 25,
offset_dir = "neg")
