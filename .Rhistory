logistic_results = map(glm_list, tidy), # Do the map and also take note of which model
model = model
) %>%
select(-glm_list) %>% # Gets rid of the actual models (necessary for saving as csv)
unnest(logistic_results)# Unnests results
temp_diagnostics <- single_cals_modelled_bin10 %>%
select(1, 2, all_of(model)) %>%
rename(glm_list = 3) %>%
mutate(
logistic_diagnostics = map(glm_list, glance),
model = model
) %>%
select(-glm_list) %>%
unnest(logistic_diagnostics)
single_cals_log_results_bin10 <- rbind(single_cals_log_results, temp_results)
single_cals_log_diagnostics_bin10 <- rbind(single_cals_log_diagnostics,
temp_diagnostics)
}
model_names <- colnames(single_cals_modelled_bin10)[4:11]
single_cals_log_results_bin10 <- data.frame()
single_cals_log_diagnostics_bin10 <- data.frame()
for (model in model_names) {
## This will get a little experimental - we are trying to create a big old table!
## First, we thin down the DF to the model of interest
temp_results <- single_cals_modelled_bin10 %>%
select(1, 2, all_of(model)) %>% #All of used to address deprecation
rename(glm_list = 3) %>% #This rename allows map to work correctly
mutate(
logistic_results = map(glm_list, tidy), # Do the map and also take note of which model
model = model
) %>%
select(-glm_list) %>% # Gets rid of the actual models (necessary for saving as csv)
unnest(logistic_results)# Unnests results
temp_diagnostics <- single_cals_modelled_bin10 %>%
select(1, 2, all_of(model)) %>%
rename(glm_list = 3) %>%
mutate(
logistic_diagnostics = map(glm_list, glance),
model = model
) %>%
select(-glm_list) %>%
unnest(logistic_diagnostics)
single_cals_log_results_bin10 <- rbind(single_cals_log_results_bin10, temp_results)
single_cals_log_diagnostics_bin10 <- rbind(single_cals_log_diagnostics_bin10,
temp_diagnostics)
}
write_csv(single_cals_log_results_bin10,
"model_results/single_cals_log_results_bin10.csv")
write_csv(single_cals_log_diagnostics_bin10,
"model_results/single_cals_log_diagnostics_bin10.csv")
single_cals_log_results %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
filter(!(target_year %in% c(7019, 7751, 9076, 11091) &
str_detect(model, "95"))) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = offset_pos), alpha = 0.2, color = "grey75") +
geom_line(aes(color = offset_pos), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
)
single_cals_log_results_bin10 <- read_csv(
"model_results/single_cals_log_results_bin10.csv")
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = offset_pos), alpha = 0.2, color = "grey75") +
geom_line(aes(color = offset_pos), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
)
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = hpd_area), alpha = 0.2, color = "grey75") +
geom_line(aes(color = offset_pos), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
)
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = offset_pos), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
)
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Model", values = c("steelblue", "darkblue")) +
scale_color_discrete(name = "Model")
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Model", values = c("steelblue", "darkblue")) +
scale_color_discrete(name = "Model", values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Model", values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey70", size = 0.5),
panel.border = element_blank(),
axis.line = element_line(colour = "grey40")
strip.background = element_rect(
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey70", size = 0.5),
panel.border = element_blank(),
axis.line = element_line(colour = "grey40"),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey90", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey40"),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey90", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey90", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey80", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model), scales = "free") +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey80", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
legend.position = "none",
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "darkblue")) +
scale_color_manual(values = c("steelblue", "darkblue"))
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
ylim(c(-2, 2)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey80", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
legend.position = "none",
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Parameter", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "Parameter")
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
ylim(c(-0.25, 0.25)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey80", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
legend.position = "none",
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Parameter", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "Parameter")
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
#ylim(c(-0.25, 0.25)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey80", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
legend.position = "none",
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Parameter", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "Parameter")
single_cals_log_results_bin10 %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
#ylim(c(-0.25, 0.25)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
panel.grid.major = element_line(colour = "grey80", size = 0.1),
panel.border = element_blank(),
axis.line = element_line(colour = "grey50", size = 0.5),
#legend.position = "none",
strip.background = element_rect(
color="white", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Parameter", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "Parameter")
