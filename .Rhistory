theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white",
text = element_text(family = "Garamond")
)) +
labs(x = "Cal yrs BP")
## Lets make some plots
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "68")) %>%
ggplot(aes(x = target_year, y = AIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos) +
theme_bw() +
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Garamond")
) +
labs(x = "Cal yrs BP")
## Lets make some plots
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "68")) %>%
ggplot(aes(x = target_year, y = AIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos) +
theme_bw() +
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Garamond")
) +
labs(x = "Cal yrs BP")
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "68")) %>%
ggplot(aes(x = target_year, y = BIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos, labeller = labeller(c("Pos offset", "Neg offset"))) +
theme_bw() +
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
)) +
labs(x = "Cal yrs BP")
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "95")) %>%
ggplot(aes(x = target_year, y = AIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos) +
theme_bw()+
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
)) +
labs(x = "Cal yrs BP")
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "95")) %>%
ggplot(aes(x = target_year, y = BIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos) +
theme_bw() +
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
)) +
labs(x = "Cal yrs BP")
## Lets make some plots
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "68")) %>%
ggplot(aes(x = target_year, y = AIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos) +
theme_bw() +
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
labs(x = "Cal yrs BP")
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "68")) %>%
ggplot(aes(x = target_year, y = BIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos, labeller = labeller(c("Pos offset", "Neg offset"))) +
theme_bw() +
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
)) +
labs(x = "Cal yrs BP")
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "95")) %>%
ggplot(aes(x = target_year, y = AIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos) +
theme_bw()+
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
)) +
labs(x = "Cal yrs BP")
single_cals_log_diagnostics %>%
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
) %>%
filter(str_detect(model, "95")) %>%
ggplot(aes(x = target_year, y = BIC)) +
geom_line(aes(color = model)) +
facet_wrap(~offset_pos) +
theme_bw() +
scale_color_manual(values = c("darkblue", "blue", "steelblue", "gray")) +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
)) +
labs(x = "Cal yrs BP")
single_cals_log_results %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
filter(!(target_year %in% c(7019, 7751, 9076, 11091) &
str_detect(model, "95"))) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
ylim(c(-2, 2)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
)) +
single_cals_log_results %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
filter(!(target_year %in% c(7019, 7751, 9076, 11091) &
str_detect(model, "95"))) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
ylim(c(-2, 2)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(values = c("steelblue", "grey50", "darkblue"))
single_cals_log_results %>%
filter(!str_detect(model, "95") & !str_detect(model, "sigma_only")) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_line(aes(color = model))
single_cals_log_results %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
filter(!(target_year %in% c(7019, 7751, 9076, 11091) &
str_detect(model, "95"))) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
ylim(c(-2, 2)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "", values = c("steelblue", "grey50", "darkblue"))
single_cals_log_results %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
filter(!(target_year %in% c(7019, 7751, 9076, 11091) &
str_detect(model, "95"))) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
ylim(c(-2, 2)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "")
single_cals_log_results %>%
filter(!str_detect(model, "95") & !str_detect(model, "sigma_only")) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term))
single_cals_log_results %>%
filter(!str_detect(model, "95") & !str_detect(model, "sigma_only")) %>%
filter(!str_detect(term, "Intercept")) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term))
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term))
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model, alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term))
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term))
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
)%>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term))
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
)%>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "")
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
)%>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0, size = 2) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "")
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
)%>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0, size = 1) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "")
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
)%>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0, size = 1) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Model", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "Model")
single_cals_log_results %>%
filter(str_detect(model, "interact") & !str_detect(term, "Intercept")) %>%
filter(!(target_year %in% c(7019, 7751, 9076, 11091) &
str_detect(model, "95"))) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset"),
model = if_else(str_detect(model, "68"), "68.2% HPD", "95.4% HPD")
) %>%
ggplot(aes(x = target_year, y = estimate)) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = term), alpha = 0.2, color = "grey75") +
geom_line(aes(color = term), linetype = "dotted") +
facet_grid(cols = vars(offset_pos), rows = vars(model)) +
ylim(c(-2, 2)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Parameter", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "Parameter")
single_cals_log_results %>%
filter(!str_detect(model, "95") &
!str_detect(model, "sigma_only") &
!str_detect(term, "Intercept") &
!str_detect(term, "error:offset")) %>%  ## This removes extreme values of the 95% model in the visualizations
mutate(
offset_pos = if_else(offset_pos, "Pos offset", "Neg offset")
)%>%
ggplot(aes(x = target_year, y = estimate)) +
geom_hline(yintercept = 0, size = 0.5) +
geom_ribbon(aes(ymin = estimate - std.error * 2,
ymax = estimate + std.error * 2,
fill = model), alpha = 0.2, color = "grey75") +
geom_line(aes(color = model)) +
facet_grid(cols = vars(offset_pos), rows = vars(term)) +
theme_bw() +
theme(
panel.grid.minor = element_blank(),
strip.background = element_rect(
color="black", fill="white"
),
text = element_text(family = "Corbel")
) +
scale_fill_manual(name = "Model", values = c("steelblue", "grey50", "darkblue")) +
scale_color_discrete(name = "Model")
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider <- single_cals_log_results %>%
filter(str_detect(model, "interaction"))
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider <- single_cals_log_results %>%
filter(str_detect(model, "interact"))
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider <- single_cals_log_results %>%
filter(str_detect(model, "interact")) %>%
pivot_wider(names_from = term, values_from = c(estimate, std.error))
View(single_cals_log_results_wider)
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider <- single_cals_log_results %>%
filter(str_detect(model, "interact")) %>%
select(-statistic, -p.vlaue)
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider <- single_cals_log_results %>%
filter(str_detect(model, "interact")) %>%
select(-c(statistic, p.vlaue))
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider <- single_cals_log_results %>%
filter(str_detect(model, "interact")) %>%
select(!c(statistic, p.value))
View(single_cals_log_results_wider)
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider <- single_cals_log_results %>%
filter(str_detect(model, "interact")) %>%
select(!c(statistic, p.value)) %>%
pivot_wider(names_from = term, values_from = c(estimate, std.error))
View(single_cals_log_results_wider)
## this will get a little messy. In order for the thing to work efficiently, it will be easier to pivot the table wider
single_cals_log_results_wider_pos <- single_cals_log_results %>%
filter(str_detect(model, "interact") & offset_pos) %>%
select(!c(statistic, p.value)) %>%
pivot_wider(names_from = term, values_from = c(estimate, std.error))
single_cals_log_results_wider_neg <- single_cals_log_results %>%
filter(str_detect(model, "interact") & !offset_pos) %>%
select(!c(statistic, p.value)) %>%
pivot_wider(names_from = term, values_from = c(estimate, std.error))
